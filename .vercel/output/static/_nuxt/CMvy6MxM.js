import{r as u,c as l,a as t,g as f,F as g,f as k,h as V,d as v,i as b,v as x,t as r,j as S,o}from"./DoWHJ2FZ.js";import{u as q}from"./BCqbGBHg.js";const B={class:"max-w-3xl mx-auto p-6 space-y-6"},C={key:0,class:"text-gray-600"},N={key:1},T={class:"space-y-2 border p-4 rounded"},U={class:"font-semibold"},D={class:"text-sm text-gray-700"},E={class:"mt-1"},F={class:"block"},M={class:"block"},O={class:"block"},j={key:0,class:"text-red-600 italic"},L={key:2,class:"text-green-600 text-lg"},A={__name:"checkout",setup(P){const i=q(),d=u(""),m=u(""),p=u(""),a=u(""),c=u(!1),_=async()=>{if(a.value="",!d.value||!m.value||!p.value){a.value="Пожалуйста, заполните все поля.";return}try{const n=await $fetch("/api/send-order",{method:"POST",body:{name:d.value,phone:m.value,email:p.value,items:i.items}});n.ok?(c.value=!0,a.value="Спасибо! Ваш заказ отправлен.",i.clearCart()):a.value="Ошибка при отправке письма: "+n.error}catch(n){a.value="Ошибка сети или сервера: "+n.message}};return(n,e)=>(o(),l("div",B,[e[9]||(e[9]=t("h1",{class:"text-2xl font-bold mb-4"},"Оформление заказа",-1)),f(i).items.length===0&&!c.value?(o(),l("div",C," Ваша корзина пуста. ")):c.value?(o(),l("div",L,r(a.value),1)):(o(),l("div",N,[e[8]||(e[8]=t("h2",{class:"text-xl font-semibold mb-2"},"Товары в корзине:",-1)),t("ul",T,[(o(!0),l(g,null,k(f(i).items,(s,w)=>(o(),l("li",{key:w,class:"border-b pb-2"},[t("div",U,r(s.title),1),t("ul",D,[(o(!0),l(g,null,k(s.options,(h,y)=>(o(),l("li",{key:y},r(y)+": "+r(h),1))),128))]),t("div",E,[e[3]||(e[3]=v(" Цена: ")),t("strong",null,r(s.price)+" ₽",1)])]))),128))]),t("form",{class:"mt-6 space-y-4",onSubmit:S(_,["prevent"])},[t("label",F,[e[4]||(e[4]=v(" Имя: ")),b(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),type:"text",required:"",class:"mt-1 border px-2 py-1 w-full"},null,512),[[x,d.value]])]),t("label",M,[e[5]||(e[5]=v(" Телефон: ")),b(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s),type:"tel",required:"",class:"mt-1 border px-2 py-1 w-full"},null,512),[[x,m.value]])]),t("label",O,[e[6]||(e[6]=v(" Email: ")),b(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>p.value=s),type:"email",required:"",class:"mt-1 border px-2 py-1 w-full"},null,512),[[x,p.value]])]),a.value?(o(),l("div",j,r(a.value),1)):V("",!0),e[7]||(e[7]=t("button",{type:"submit",class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded shadow"}," Отправить заказ ",-1))],32)]))]))}};export{A as default};
